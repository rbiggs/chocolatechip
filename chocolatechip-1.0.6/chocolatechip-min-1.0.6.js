/*
* ChocolateChip
* A small, light JavaScript framework for mobile Web app development, providing the functionality necessary for creating professional HTML5/CSS3-based Web apps.
* 
* LICENSE: BSD
* 
* Copyright (c) 2010, Robert Biggs
* All rights reserved.
*/
(function(){var $=function(a){return document.querySelector(a)};$.extend=function(a,b){for(var c in b){if(b.hasOwnProperty(c)){Object.defineProperty(a,c,{value:b[c],writable:true,enumerable:false,configurable:true})}}};$.extend($,{version:"1.0.6",collectionToArray:function(a){var b=[];var i=0,len=a.length;while(i<len){b[i]=a[i];i++}return b},$$:function(a){return $.collectionToArray(document.querySelectorAll(a))}});$.extend(HTMLElement.prototype,{previous:function(){return this.previousElementSibling},next:function(){return this.nextElementSibling},first:function(){return this.firstElementChild},last:function(){return this.lastElementChild},ancestorByTag:function(a){var p=this.parentNode;if(!p){return false}if(p.tagName.toLowerCase()==a){return p}else{return p.ancestorByTag(a)}},ancestorByClass:function(a){var p=this.parentNode;if(!p){return false}if(p.hasClass(a)){return p}else{return p.ancestorByClass(a)}}});$.extend($,{make:function(a){var b=[];var c=document.createElement("div");c.innerHTML=a;var i=0;var d=c.childNodes.length;while(i<d){b[i]=c.childNodes[i];i++}return b}});$.extend(HTMLElement.prototype,{empty:function(){this.removeEvents();this.textContent=""},clone:function(a){if(a===true||!a){return this.cloneNode(true)}else{return this.cloneNode(false)}},wrap:function(a){var b=$.make(a);b=b[0];var c=this.clone(true);b.appendChild(c);this.after(b,this);this.remove(this)}});$.extend($,{replace:function(a,b){b.parentNode.replaceChild(a,b)}});$.extend(HTMLElement.prototype,{unwrap:function(){if(this.parentNode.nodeName==="BODY"){return false}var a=this.cloneNode(true);$.replace(a,this.parentNode)},text:function(a){if(!!a){this.innerText=a}else{return this.innerText}},fill:function(a){this.empty();if(typeof a==="string"){this.textContent=a}else{this.insert(a)}},empty:function(){this.removeEvents();this.textContent=""},remove:function(){this.removeEvents();this.parentNode.removeChild(this)},insert:function(a,b){if(b===1||(typeof b==="string"&&b==="first")){if(typeof a==="string"){var c=$.make(a);var i=0,len=c.length;while(i<len){this.insertBefore(c[i],this.firstElementChild);i++}}else{var i=0,len=a.length;while(i<len){this.insertBefore(a[i],this.firstElementChild);i++}}}else if(!b||(typeof b==="string"&&b==="last")){if(typeof a==="string"){var c=$.make(a);var i=0,len=c.length;while(i<len){this.appendChild(c[i]);i++}}else{var i=0,len=a.length;while(i<len){this.appendChild(a[i]);i++}}}else{var d=this.children(el);if(typeof d==="undefined"){if(typeof a==="string"){var c=$.make(a);var i=0,len=c.length;while(i<len){this.appendChild(c[i]);i++}}else{var i=0,len=a.length;while(i<len){this.appendChild(a[i]);i++}}}else{if(typeof a==="string"){var c=$.make(a);var i=0,len=c.length;while(i<len){this.insertBefore(c[i],this.children[b-1]);i++}}else{var i=0,len=a.length;while(i<len){this.insertBefore(a[i],this.children[b-1]);i++}}}}return this},before:function(a){if(a.constructor===Array){var b=a.length;var i=0;while(i<b){this.parentNode.insertBefore(a[i],this);i++}}else{this.parentNode.insertBefore(a,this)}},after:function(a){var b=this.parentNode;if(a.constructor===Array){var i=0,len=a.length;while(i<len){if(this===b.lastChild){b.appendChild(a[i])}else{b.insertBefore(a[i],this.nextSibling)}i++}}else{if(a===this.lastChild){b.appendChild(a)}else{b.insertBefore(a,this.next())}}},hasClass:function(a){return new RegExp('(?:^|\\s+)'+a+'(?:\\s+|$)').test(this.className)},addClass:function(a){if(!this.hasClass(a)){this.className=[this.className,a].join(' ').replace(/^\s*|\s*$/g,"")}},removeClass:function(a){if(this.hasClass(a)){var b=this.className;this.className=b.replace(new RegExp('(?:^|\\s+)'+a+'(?:\\s+|$)','g'),' ').replace(/^\s*|\s*$/g,"")}},toggleClass:function(a,b){if(!b){if(!this.hasClass(a)){this.addClass(a)}else{this.removeClass(a)}}else if(b){if(!this.hasClass(a)){this.addClass(a);this.removeClass(b)}else{this.removeClass(a);this.addClass(b)}}}});$.extend($,{style:function(a,b){return document.defaultView.getComputedStyle(a,null).getPropertyValue(b.toLowerCase())}});$.extend(HTMLElement.prototype,{css:function(a,b){if(b){this.style.cssText=a;return this}else{this.style.cssText+=";"+a;return this}},bind:function(a,b){this.addEventListener(a,b,false)},unbind:function(a,b){this.removeEventListener(a,b,false)},removeEvents:function(){var i=0,len=$.events.length;while(i<len){this[$.events[i]]=null;i++}}});$.extend($,{events:['onmousedown','onmouseup','onmouseover','onmouseout','onclick','onmousemove','ondblclick','onerror','onresize','onscroll','onkeydown','onkeyup','onkeypress','onchange','onsubmit','onload','ontouchstart','ontouchmove','ontouchend','ontouchcancel','ongesturestart','ongesturechange','ongestureend','onorientationchange'],loadEvent:function(F){var a=window.onload;if(typeof window.onload!=='function'){window.onload=F}else{window.onload=function(){a();F()}}},ready:function(a){document.addEventListener("DOMContentLoaded",a,false)}});$.extend(HTMLElement.prototype,{xhr:function(a,b){var o=b?b:{};if(!!b){if(!!b.successCallback){o.callback=b.successCallback}}var c=this,request=new XMLHttpRequest(),method=o.method||'get',async=o.async||false,params=o.data||null,i=0;request.queryString=params;request.open(method,a,async);if(o.headers){for(;i<o.headers.length;i++){request.setRequestHeader(o.headers[i].name,o.headers[i].value)}}request.handleResp=(o.callback!=null)?o.callback:function(){c.insert(this.responseText)};function hdl(){if(request.status===0||request.status==200&&request.readyState==4){$.responseText=request.responseText;request.handleResp()}else{b.errorCallback()}}if(async)req.onreadystatechange=hdl;request.send(params);if(!async)hdl();return this},xhrjson:function(b,d){if(d==="undefined"){return this}var c=d.callback;if(typeof c!='function'){c=function(x){return x}}var e=function(){var o=eval('('+this.responseText+')');for(var a in o){$(d[a]).fill(c(o[a]))}};d.successCallback=e;this.xhr(b,d);return this}});$.extend($,{hideURLbar:function(){window.scrollTo(0,1)},importScript:function(a){var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src",a);$("head").appendChild(b)},iphone:/iphone/i.test(navigator.userAgent),ipad:/ipad/i.test(navigator.userAgent),ipod:/ipod/i.test(navigator.userAgent),android:/android/i.test(navigator.userAgent),webos:/webos/i.test(navigator.userAgent),blackberry:/blackberry/i.test(navigator.userAgent),online:navigator.onLine,standalone:navigator.standalone});window.addEventListener("orientationchange",function(){if(window.orientation===0||window.orientation===180){$("body").removeClass("landscape");$("body").addClass("portrait");$.hideURLbar()}else{$("body").removeClass("portrait");$("body").addClass("landscape");$.hideURLbar()}},false);if((!window.$)&&(!window.$$)){window.$=$;window.$$=$.$$}else{window.__$=$;window.__$$=$.$$}})("ChocolateChip");